<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Assignment_ResearchTrackII: src/goals.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Assignment_ResearchTrackII
   </div>
   <div id="projectbrief">Documentation about robot&#39;s controls</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">goals.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>software architecture for the control of the robot in the environment  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;ros/ros.h&gt;</code><br />
<code>#include &lt;move_base_msgs/MoveBaseAction.h&gt;</code><br />
<code>#include &lt;actionlib/client/simple_action_client.h&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &quot;geometry_msgs/Twist.h&quot;</code><br />
<code>#include &quot;sensor_msgs/LaserScan.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for goals.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="goals_8cpp__incl.png" border="0" usemap="#src_2goals_8cpp" alt=""/></div>
<map name="src_2goals_8cpp" id="src_2goals_8cpp">
<area shape="rect" title="software architecture for the control of the robot in the environment" alt="" coords="501,5,607,32"/>
<area shape="rect" title=" " alt="" coords="5,87,84,114"/>
<area shape="rect" title=" " alt="" coords="109,87,373,114"/>
<area shape="rect" title=" " alt="" coords="397,80,564,121"/>
<area shape="rect" title=" " alt="" coords="589,87,669,114"/>
<area shape="rect" title=" " alt="" coords="693,87,869,114"/>
<area shape="rect" title=" " alt="" coords="893,87,1082,114"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a21e20cc0b6656ae897b3cbb969b93241"><td class="memItemLeft" align="right" valign="top"><a id="a21e20cc0b6656ae897b3cbb969b93241"></a>
typedef actionlib::SimpleActionClient&lt; move_base_msgs::MoveBaseAction &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#a21e20cc0b6656ae897b3cbb969b93241">MoveBaseClient</a></td></tr>
<tr class="memdesc:a21e20cc0b6656ae897b3cbb969b93241"><td class="mdescLeft">&#160;</td><td class="mdescRight">global actionclient. <br /></td></tr>
<tr class="separator:a21e20cc0b6656ae897b3cbb969b93241"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af5aabcc533f3c2e55959a3d09320e99a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#af5aabcc533f3c2e55959a3d09320e99a">distCallback</a> (const sensor_msgs::LaserScan::ConstPtr &amp;<a class="el" href="goals_8cpp.html#a44838ac64b5c8a5026bf42afbebbda22">scan</a>)</td></tr>
<tr class="memdesc:af5aabcc533f3c2e55959a3d09320e99a"><td class="mdescLeft">&#160;</td><td class="mdescRight">callback for controlling the distance between the robot and the obstacles around it in order to avoid collision with them.  <a href="goals_8cpp.html#af5aabcc533f3c2e55959a3d09320e99a">More...</a><br /></td></tr>
<tr class="separator:af5aabcc533f3c2e55959a3d09320e99a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="memdesc:a3c04138a5bfe5d72780bb7e82a18e627"><td class="mdescLeft">&#160;</td><td class="mdescRight">main function which controls the robot's behaviour.  <a href="goals_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">More...</a><br /></td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a64acaadb68ab8e4dfbb9db0f7edb30b2"><td class="memItemLeft" align="right" valign="top"><a id="a64acaadb68ab8e4dfbb9db0f7edb30b2"></a>
geometry_msgs::Twist&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#a64acaadb68ab8e4dfbb9db0f7edb30b2">base_cmd</a></td></tr>
<tr class="memdesc:a64acaadb68ab8e4dfbb9db0f7edb30b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">velocity of the robot. <br /></td></tr>
<tr class="separator:a64acaadb68ab8e4dfbb9db0f7edb30b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44838ac64b5c8a5026bf42afbebbda22"><td class="memItemLeft" align="right" valign="top"><a id="a44838ac64b5c8a5026bf42afbebbda22"></a>
sensor_msgs::LaserScan&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#a44838ac64b5c8a5026bf42afbebbda22">scan</a></td></tr>
<tr class="memdesc:a44838ac64b5c8a5026bf42afbebbda22"><td class="mdescLeft">&#160;</td><td class="mdescRight">laser scan information. <br /></td></tr>
<tr class="separator:a44838ac64b5c8a5026bf42afbebbda22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89890f177e42499c60d6a39116be9b66"><td class="memItemLeft" align="right" valign="top"><a id="a89890f177e42499c60d6a39116be9b66"></a>
ros::Publisher&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#a89890f177e42499c60d6a39116be9b66">scan_pub</a></td></tr>
<tr class="memdesc:a89890f177e42499c60d6a39116be9b66"><td class="mdescLeft">&#160;</td><td class="mdescRight">global publisher to the /scan topic. <br /></td></tr>
<tr class="separator:a89890f177e42499c60d6a39116be9b66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a350594df3e8f6948c8462edfd41ce086"><td class="memItemLeft" align="right" valign="top"><a id="a350594df3e8f6948c8462edfd41ce086"></a>
ros::Publisher&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#a350594df3e8f6948c8462edfd41ce086">pub</a></td></tr>
<tr class="memdesc:a350594df3e8f6948c8462edfd41ce086"><td class="mdescLeft">&#160;</td><td class="mdescRight">global publisher to the /cmd_vel topic. <br /></td></tr>
<tr class="separator:a350594df3e8f6948c8462edfd41ce086"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0da36b2558901e21e7a30f6c227a45e"><td class="memItemLeft" align="right" valign="top"><a id="ad0da36b2558901e21e7a30f6c227a45e"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#ad0da36b2558901e21e7a30f6c227a45e">x</a></td></tr>
<tr class="memdesc:ad0da36b2558901e21e7a30f6c227a45e"><td class="mdescLeft">&#160;</td><td class="mdescRight">goal's coordinates inserted by the user. <br /></td></tr>
<tr class="separator:ad0da36b2558901e21e7a30f6c227a45e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4f0d3eebc3c443f9be81bf48561a217"><td class="memItemLeft" align="right" valign="top"><a id="aa4f0d3eebc3c443f9be81bf48561a217"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a></td></tr>
<tr class="memdesc:aa4f0d3eebc3c443f9be81bf48561a217"><td class="mdescLeft">&#160;</td><td class="mdescRight">goal's coordinates inserted by the user. <br /></td></tr>
<tr class="separator:aa4f0d3eebc3c443f9be81bf48561a217"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d055a05b7de1e0898d6da92e2725e5e"><td class="memItemLeft" align="right" valign="top"><a id="a5d055a05b7de1e0898d6da92e2725e5e"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#a5d055a05b7de1e0898d6da92e2725e5e">cmd</a></td></tr>
<tr class="memdesc:a5d055a05b7de1e0898d6da92e2725e5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">command inserted by keyboard for moving the robot. <br /></td></tr>
<tr class="separator:a5d055a05b7de1e0898d6da92e2725e5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38deedb02dcebac366f97a0879b3be5b"><td class="memItemLeft" align="right" valign="top"><a id="a38deedb02dcebac366f97a0879b3be5b"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#a38deedb02dcebac366f97a0879b3be5b">input</a></td></tr>
<tr class="memdesc:a38deedb02dcebac366f97a0879b3be5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">guide mode choosen by the user. <br /></td></tr>
<tr class="separator:a38deedb02dcebac366f97a0879b3be5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6bbfe37bfa912a1db55f6c1733cc64e"><td class="memItemLeft" align="right" valign="top"><a id="aa6bbfe37bfa912a1db55f6c1733cc64e"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#aa6bbfe37bfa912a1db55f6c1733cc64e">value_front</a></td></tr>
<tr class="memdesc:aa6bbfe37bfa912a1db55f6c1733cc64e"><td class="mdescLeft">&#160;</td><td class="mdescRight">distances from the obstacle on the robot's front. <br /></td></tr>
<tr class="separator:aa6bbfe37bfa912a1db55f6c1733cc64e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa779bed26d81f68c2ad205a5855b4ce"><td class="memItemLeft" align="right" valign="top"><a id="aaa779bed26d81f68c2ad205a5855b4ce"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#aaa779bed26d81f68c2ad205a5855b4ce">value_right</a></td></tr>
<tr class="memdesc:aaa779bed26d81f68c2ad205a5855b4ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">distances from the obstacle on the robot's right. <br /></td></tr>
<tr class="separator:aaa779bed26d81f68c2ad205a5855b4ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dfe4cc7117dfedaa96eace4cbd901a6"><td class="memItemLeft" align="right" valign="top"><a id="a3dfe4cc7117dfedaa96eace4cbd901a6"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="goals_8cpp.html#a3dfe4cc7117dfedaa96eace4cbd901a6">value_left</a></td></tr>
<tr class="memdesc:a3dfe4cc7117dfedaa96eace4cbd901a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">distances from the obstacle on the robot's left. <br /></td></tr>
<tr class="separator:a3dfe4cc7117dfedaa96eace4cbd901a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>software architecture for the control of the robot in the environment </p>
<dl class="section author"><dt>Author</dt><dd>Martina Germani </dd></dl>
<dl class="section date"><dt>Date</dt><dd>27/07/2022</dd></dl>
<p>The type of robot's control depends on user's input. In particular, if the user enters the letter "a", the robot has to autonomously reach a (x,y) coordinate inserted by the user; if the user enters the letter "m", the user itself can manually drive the robot using the keyboard; if, instead, the user enters the letter "c", the user can manually drive the robot using the keyboard, but there are some controls in order to avoid collision with the edges of the environment.</p>
<p>Subscribes to:<br  />
 /scan which is a topic that in the field "ranges" contains information about the distance between the robot and the obstacles</p>
<p>Publishes to:<br  />
 /scan /cmd_vel</p>
<p>Client:<br  />
 /client/simple_action_client</p>
<p>Description :</p>
<p>This node simulates a robot's control depending on the input inserted by the user. If the user chooses the "automatic guide" (letter "a"), the move_base package requires goal to be sent to the move_base/goal topic; in this way, the move_base action accepts goal from client and attempts to move the robot to the specified position. If the user chooses the "manual guide" (letter "m"), the user can press some keyboard keys so as to move the robot in the desired direction; in particular, it can press "+" in order to move the robot on a straight line, "r" in order to turn right the robot, "l" in order to turn left the robot, "s" in order to stop the robot or "." in order to change the guide mode. If the user chooses the "controlled guide" (letter "c"), the user can move the robot as in the "manual guide", but there are some controls releted to the distance from the obstacles; for doing that there are a publisher and a subscriber to the topic /scan of the robot, in fact its field "ranges" contains information about the distance between the robot and the obstacles around it. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af5aabcc533f3c2e55959a3d09320e99a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5aabcc533f3c2e55959a3d09320e99a">&#9670;&nbsp;</a></span>distCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void distCallback </td>
          <td>(</td>
          <td class="paramtype">const sensor_msgs::LaserScan::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>scan</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>callback for controlling the distance between the robot and the obstacles around it in order to avoid collision with them. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scan</td><td>robot's laser</td></tr>
  </table>
  </dd>
</dl>
<p>This function, while the user moves the robot using the keyboard, controls the distance between the robot and the obstacles around it: this information is contained in the field "ranges" of the topic /scan. More in detail, if the user enters "+", this function controls the distance between the robot and the obstacle in front of it: if it is close, the robot stops, otherwise it moves on a straight line. If, instead, the user enters "l", this function controls the distance between the robot and the obstacle on the left: if it is close, the robot turns right instead of left, otherwise it turns left. If the user enters "r", this function controls the distance between the robot and the obstacle on the right: if it is close, the robot turns left instead of right, otherwise it turns right. </p>

</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>main function which controls the robot's behaviour. </p>
<p>This function creates a node, called "goal_node", two publishers (one to the topic /cmd_vel and one to the /scan topic) and a subscriber to the /scan topic. Once the user chose how to move the robot, this function implements some controls. More in details, if the user enters "a", it constructs an action client used to communicate with the move_base action, then waits for the action server to come up and creates a goal to send to the move_base; at this point, the user enters the desired position, and this function controls if the inserted target is reachable or not: if it is not reachable, it will be deleted, otherwise it waits for the goal to finish. If the user enters "m", the user can move the robot using the keyboard, so this function contains the code which builds some commands for doing that. In particular, if the user enters "+", it moves the robot on a straight line modifying its linear velocity and publishing it on the /cmd_vel topic; if the user enters "r", it turns right the robot modifying its angular velocity and publishing it on /cmd_vel topic; if the user enters "l", it turns left the robot, modifying its angular velocity and publishing it on /cmd_vel * topic; if the user enters "s", it stops the robot by putting to zero both its linear and angular velocity and publishing them on the /cmd_vel topic; if, instead, the user enters ".", it changes the guide mode. If the user enters "c", the distCallback function is executed. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
